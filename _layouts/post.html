---
layout: default
---

<div class="home-container">
<div class="reading-progress">
  <div class="reading-progress-bar"></div>
</div>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">{{ page.title | escape }}</h1>
    <p class="post-meta">
      <time datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">
        {{ page.date | date: "%b %d, %Y" }}
      </time>
      {% if page.categories.size > 0 %}
        • Categories: 
        {% for category in page.categories %}
          <a href="/categories/{{ category | slugify }}">{{ category }}</a>
          {% unless forloop.last %}, {% endunless %}
        {% endfor %}
      {% endif %}
      {% if page.tags.size > 0 %}
        • Tags: 
        {% for tag in page.tags %}
          <a href="/tags/{{ tag | slugify }}">{{ tag }}</a>
          {% unless forloop.last %}, {% endunless %}
        {% endfor %}
      {% endif %}
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    {{ content }}
  </div>

  {% if page.mermaid %}
    {% include mermaid.html %}
  {% endif %}

  {% if site.giscus.repo %}
    {% include giscus_comments.html %}
  {% endif %}

  <div class="post-navigation">
    {% if page.previous.url %}
      <a class="prev" href="{{page.previous.url}}">&laquo; {{page.previous.title}}</a>
    {% endif %}
    {% if page.next.url %}
      <a class="next" href="{{page.next.url}}">{{page.next.title}} &raquo;</a>
    {% endif %}
  </div>

  <div class="social-share">
    <span>分享到：</span>
    <a href="https://twitter.com/intent/tweet?text={{ page.title | url_encode }}&url={{ site.url }}{{ page.url | url_encode }}" target="_blank" title="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
    <a href="https://www.facebook.com/sharer/sharer.php?u={{ site.url }}{{ page.url | url_encode }}" target="_blank" title="Facebook">
      <i class="fab fa-facebook"></i>
    </a>
    <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ site.url }}{{ page.url | url_encode }}&title={{ page.title | url_encode }}" target="_blank" title="LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>
    <a href="https://service.weibo.com/share/share.php?url={{ site.url }}{{ page.url | url_encode }}&title={{ page.title | url_encode }}" target="_blank" title="微博">
      <i class="fab fa-weibo"></i>
    </a>
  </div>

  {% assign max_related = 5 %}
  {% assign min_common_tags = 1 %}
  {% assign related_posts = "" | split: "" %}

  {% if page.tags.size > 0 %}
    {% for i in (1..page.tags.size) reversed %}
      {% for post in site.posts %}
        {% if post.url == page.url %}{% continue %}{% endif %}
        
        {% assign common_tags_count = 0 %}
        {% for tag in post.tags %}
          {% if page.tags contains tag %}
            {% assign common_tags_count = common_tags_count | plus: 1 %}
          {% endif %}
        {% endfor %}
        
        {% if common_tags_count == i %}
          {% unless related_posts contains post %}
            {% assign related_posts = related_posts | push: post %}
          {% endunless %}
        {% endif %}
      {% endfor %}
      {% if related_posts.size >= max_related %}{% break %}{% endif %}
    {% endfor %}
  {% endif %}

  {% if related_posts.size > 0 %}
  <div class="related-posts">
    <h3>相关文章</h3>
    <ul>
      {% for post in related_posts limit:max_related %}
      <li>
        <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
        <span class="post-date">{{ post.date | date: "%Y-%m-%d" }}</span>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</article>
</div>
