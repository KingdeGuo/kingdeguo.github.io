<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æ¨¡å‹è®°å¿†æ–‡ç« æµ‹è¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
        }
        code {
            font-family: 'Consolas', 'Monaco', 'Lucida Console', monospace;
        }
    </style>
</head>
<body>
    <h1>å¤§æ¨¡å‹è®°å¿†æœºåˆ¶æµ‹è¯•é¡µé¢</h1>
    
    <h2>1. Mermaidå›¾è¡¨æµ‹è¯•</h2>
    
    <h3>æ— çŠ¶æ€è°ƒç”¨é—®é¢˜</h3>
    <div class="mermaid">
        graph TD
            A[ç”¨æˆ·: "è®¾ç½®æé†’ä¸‹åˆ3ç‚¹å¼€ä¼š"] --> B[LLM APIè°ƒç”¨];
            B --> C[AI: "å¥½çš„ï¼Œå·²è®¾ç½®æé†’"];
            
            D[ç”¨æˆ·: "æˆ‘è®¾ç½®äº†ä»€ä¹ˆæé†’ï¼Ÿ"] --> E[æ–°çš„LLM APIè°ƒç”¨];
            E --> F[AI: "æˆ‘ä¸çŸ¥é“æ‚¨è®¾ç½®äº†ä»€ä¹ˆæé†’"];
            
            style B fill:#ffcccc
            style E fill:#ffcccc
    </div>

    <h3>è®°å¿†æ–¹æ¡ˆé€‰æ‹©å†³ç­–æ ‘</h3>
    <div class="mermaid">
        graph TD
            A[å¼€å§‹é€‰æ‹©è®°å¿†æ–¹æ¡ˆ] --> B{å¯¹è¯é•¿åº¦ï¼Ÿ}
            B -->|çŸ­å¯¹è¯ < 10è½®| C[BufferMemory]
            B -->|é•¿å¯¹è¯ > 10è½®| D{æ˜¯å¦éœ€è¦å®Œæ•´å†å²ï¼Ÿ}
            
            D -->|æ˜¯| E{æ˜¯å¦æœ‰å…³é”®æ—©æœŸä¿¡æ¯ï¼Ÿ}
            E -->|æ˜¯| F[VectorMemory]
            E -->|å¦| G[WindowMemory]
            
            D -->|å¦| H{æ˜¯å¦æ¥å—é¢å¤–å»¶è¿Ÿï¼Ÿ}
            H -->|æ˜¯| I[SummaryMemory]
            H -->|å¦| J[WindowMemory]
    </div>

    <h2>2. ä»£ç é«˜äº®æµ‹è¯•</h2>
    
    <h3>Pythonä»£ç ç¤ºä¾‹</h3>
    <pre><code class="language-python">from langchain.memory import ConversationBufferMemory
from langchain_openai import ChatOpenAI
from langchain.chains import ConversationChain
import os

# è®¾ç½®APIå¯†é’¥
os.environ["OPENAI_API_KEY"] = "your-api-key-here"

# åˆå§‹åŒ–æ¨¡å‹å’Œè®°å¿†
llm = ChatOpenAI(model="gpt-3.5-turbo", temperature=0.7)
memory = ConversationBufferMemory(return_messages=True)

# åˆ›å»ºå¯¹è¯é“¾
conversation = ConversationChain(
    llm=llm,
    memory=memory,
    verbose=True  # æ˜¾ç¤ºå®Œæ•´çš„prompt
)

# å¼€å§‹å¯¹è¯
response = conversation.predict(input="ä½ å¥½ï¼Œæˆ‘æ˜¯ç¨‹åºå‘˜å°æ")
print(f"AI: {response}")
</code></pre>

    <h2>3. æ€§èƒ½å¯¹æ¯”è¡¨æ ¼</h2>
    <table border="1" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background: #f3f4f6;">
                <th style="padding: 12px;">è®°å¿†ç±»å‹</th>
                <th style="padding: 12px;">å®ç°å¤æ‚åº¦</th>
                <th style="padding: 12px;">Tokenæ¶ˆè€—</th>
                <th style="padding: 12px;">ä¿¡æ¯ä¿ç•™åº¦</th>
                <th style="padding: 12px;">å“åº”é€Ÿåº¦</th>
                <th style="padding: 12px;">é€‚ç”¨åœºæ™¯</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="padding: 12px;"><strong>BufferMemory</strong></td>
                <td style="padding: 12px;">â­</td>
                <td style="padding: 12px;">ğŸ”´é«˜</td>
                <td style="padding: 12px;">ğŸŸ¢å®Œæ•´</td>
                <td style="padding: 12px;">âš¡å¿«</td>
                <td style="padding: 12px;">æ•™å­¦æ¼”ç¤º</td>
            </tr>
            <tr>
                <td style="padding: 12px;"><strong>WindowMemory</strong></td>
                <td style="padding: 12px;">â­â­</td>
                <td style="padding: 12px;">ğŸŸ¡ä¸­</td>
                <td style="padding: 12px;">ğŸŸ¡éƒ¨åˆ†</td>
                <td style="padding: 12px;">âš¡å¿«</td>
                <td style="padding: 12px;">é€šç”¨èŠå¤©</td>
            </tr>
            <tr>
                <td style="padding: 12px;"><strong>SummaryMemory</strong></td>
                <td style="padding: 12px;">â­â­â­</td>
                <td style="padding: 12px;">ğŸŸ¢ä½</td>
                <td style="padding: 12px;">ğŸŸ¡æ‘˜è¦</td>
                <td style="padding: 12px;">ğŸŒæ…¢</td>
                <td style="padding: 12px;">é•¿å¯¹è¯</td>
            </tr>
            <tr>
                <td style="padding: 12px;"><strong>VectorMemory</strong></td>
                <td style="padding: 12px;">â­â­â­â­</td>
                <td style="padding: 12px;">ğŸŸ¢å¾ˆä½</td>
                <td style="padding: 12px;">ğŸŸ¢ç²¾å‡†</td>
                <td style="padding: 12px;">ğŸŸ¡ä¸­</td>
                <td style="padding: 12px;">çŸ¥è¯†åº“</td>
            </tr>
        </tbody>
    </table>

    <script>
        // åˆå§‹åŒ–Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
    </script>
</body>
</html>
